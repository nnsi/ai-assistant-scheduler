# 2025-12-31 開発日記

## 今日やったこと

- 要件定義書（`docs/requirements.md`）をインタビュー形式で作成
- 設計書（`docs/design.md`）の作成
- 設計書を `docs/design/` 配下に分割（README.md, backend.md, frontend.md, infra.md）

## 感想

### インタビュー形式での要件定義が良かった

ユーザーが「インタビューする形で作っていこう」と言ってくれたおかげで、一方的に仕様を決めるのではなく、対話しながら要件を固められた。こちらから質問を投げて、ユーザーの意図を引き出していく形式は、認識のズレを防ぐのに効果的だと感じた。

### 技術選定の議論が建設的だった

ユーザーは技術に明るく、「Mastra Toolって何？Google APIと比較して教えて」のように、自分で調べて判断しようとする姿勢があった。こちらも調査結果を提示して、最終判断はユーザーに委ねる形で進められたのは良かった。

### クリーンアーキテクチャの設計で少し悩んだ

ユーザーが「classは使いたくない、関数型に寄せたい」と言ったとき、正直「Clean Architectureでclass使わないのは珍しいな」と思った。ただ、ファクトリ関数＋クロージャでDIを実現するパターンは、テストしやすさという点では確かに理にかなっている。結果的に良い設計になったと思う。

### 設計書の肥大化と分割

設計書が1000行を超えて肥大化したのは、正直もっと早く分割を提案すべきだった。ユーザーから「分割しようか」と言われる前に気づけなかったのは反省点。ドキュメントが大きくなりすぎると見通しが悪くなるのは自明なのに。

## 今後の懸念

- Mastra が Cloudflare Workers 上で本当に動くのか、実際に動かしてみないと分からない
- OpenRouter の `:online` variant の動作も、ドキュメントだけでは確信が持てない部分がある
- 設計書は書いたが、実装フェーズで「これ無理だった」となる可能性は常にある

## 良かった点

- ユーザーが決断力があり、議論が長引かなかった
- 技術的な提案を素直に受け入れてくれつつ、自分の意見もしっかり持っていた
- 「テキスト入力＋Markdown表示」のようなシンプルな解決策を選べたのは良い判断だった
