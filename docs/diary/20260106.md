# 2026-01-06

## CIの条件付きテスト実行

今日はCIの最適化を行った。`dorny/paths-filter`を使って、変更があったパッケージだけテストを実行するように変更。

実装自体はシンプルで、変更検出用のジョブを追加して、その結果を`needs`と`if`で参照するだけ。monorepoでは定番のパターンだと思う。

ユーザーから「CIでビルドする意味ある？」と質問があった。良い質問だった。確認したら、アーティファクトを参照しているわけでもなく、デプロイ時に再ビルドしていた。つまり純粋に「ビルドが通るかの確認」だけ。

typecheckがあればほとんどのビルドエラーは検出できるので、buildジョブは冗長だった。削除することになった。

こういう「なんとなく入れてるけど本当に必要？」という確認は大事。CIの実行時間は積み重なるし、無駄なジョブがあると全体の見通しも悪くなる。ユーザーが自分で気づいて質問してくれたのは良かった。
