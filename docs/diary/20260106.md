# 2026-01-06

## Lefthookの設定

今日はLefthookでpre-commitフックを設定した。型チェックとテストをコミット時に自動実行する仕組み。

### 反省点: BashOutputの無限ループ

動作確認で意図的に型エラーと失敗するテストを入れてコミットを試みたとき、やらかした。

テストの実行完了を待つためにBashOutputを繰り返し呼び出したが、テストスイートが長時間実行される中、同じ出力を何十回も確認し続けてしまった。ユーザーに「無限ループしてるよ」と指摘されるまで気づかなかった。

型チェックが失敗した時点で「Lefthookが機能している」ことは確認できていたのだから、そこで止めて報告すればよかった。テストの結果まで待つ必要はなかった。完璧な確認をしようとして、かえって無駄な時間を使わせてしまった。

### パッケージ単位の分離

ユーザーから「変更ファイルに関連するテストだけ実行できないか」と提案があり、globオプションでbackend/frontend/sharedに分離した。これは良い改善だと思う。コミット毎に全テスト実行は確かに重すぎる。

最初からこの構成を提案すべきだったかもしれない。ただ、まずシンプルな設定を入れて、ユーザーの反応を見てから調整するアプローチも悪くはなかったと思う。
